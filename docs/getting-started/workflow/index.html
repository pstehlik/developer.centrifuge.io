<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Document State Consensus · Centrifuge Developer</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Now that you have installed the Centrifuge node, you can send documents such as invoices, purchase orders, and so on. The following section describes some scenarios for sending documents and how consensus on document state is reached between the collaborating parties."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Document State Consensus · Centrifuge Developer"/><meta property="og:type" content="website"/><meta property="og:url" content="https://developer.centrifuge.io//index.html"/><meta property="og:description" content="Now that you have installed the Centrifuge node, you can send documents such as invoices, purchase orders, and so on. The following section describes some scenarios for sending documents and how consensus on document state is reached between the collaborating parties."/><meta property="og:image" content="https://developer.centrifuge.io/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://developer.centrifuge.io/img/docusaurus.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-100764518-3', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/centrifuge.developer.png" alt="Centrifuge Developer"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/overview/introduction" target="_self">Docs</a></li><li class=""><a href="https://app.swaggerhub.com/apis/centrifuge.io/cent-node/0.0.3" target="_blank">Centrifuge Node API</a></li><li class=""><a href="https://github.com/centrifuge" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Getting Started</span></h2></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul><li class="navListItem"><a class="navItem" href="/docs/overview/introduction">Introduction</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul><li class="navListItem"><a class="navItem" href="/docs/getting-started/install-cent-node">Installing the Centrifuge Node</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/getting-started/workflow">Document State Consensus</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Usage</h3><ul><li class="navListItem"><a class="navItem" href="/docs/cent-os-administration/manage-cent-os">Interacting with the Centrifuge Node</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Further Reading</h3><ul><li class="navListItem"><a class="navItem" href="/docs/further-reading/auth-header">Auth Header</a></li><li class="navListItem"><a class="navItem" href="/docs/further-reading/more-info">Node API</a></li><li class="navListItem"><a class="navItem" href="/docs/further-reading/create-config">Create Config</a></li><li class="navListItem"><a class="navItem" href="/docs/further-reading/code-of-conduct">Code of Conduct</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docMainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Document State Consensus</h1></header><article><div><span><p>Now that you have installed the Centrifuge node, you can send documents such as invoices, purchase orders, and so on. The following section describes some scenarios for sending documents and how consensus on document state is reached between the collaborating parties.</p>
<p>For the peer-to-peer document exchange, the Centrifuge network considers cost-effectiveness, scalability, privacy and auditability. This requires a network that allows direct, verifiable, communication between the collaborators at high speeds without waiting for commits and transactions being propagated through the public blockchain. For this purpose, Centrifuge uses nodes that communicate in a peer-to-peer fashion to exchange cryptographically signed messages between the users.</p>
<p>To create an immutable record of the messages, their signatures, and the hashes of the messages are published to the public blockchain as an <em>anchor</em>. This anchor is created after collaborators of a document agreed on a new document state. In the case of a disagreement on documnet state, the collaborators can independently publish new anchors, essentially creating forks of a specific document. This process allows for consistent private, verifiable exchange of data and publishing new anchor versions on demand, for example, when agreement was achieved between two or more nodes on the content of a specific document.</p>
<h2><a class="anchor" aria-hidden="true" id="workflows-for-a-simple-p2p-document-exchange"></a><a href="#workflows-for-a-simple-p2p-document-exchange" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Workflows for a Simple P2P Document Exchange</h2>
<p>The following is a simplistic walkthrough of the document exchange workflow, signature, and anchoring process.</p>
<p>For the purpose of this example, we will assume two nodes A and B, where node A wants to send a document to node B. Before sending the document, node A calculates the Merkle root that uniquely identifies their document with the help of <a href="https://github.com/centrifuge/precise-proofs">precise proofs</a> and signs the root hash with a private key. At this point, user at node A has the following options:</p>
<ul>
<li>Submit the signed root hash to the public blockchain before sending the document to node B in order to anchor the document.</li>
<li>Submit the signed root hash with the document to node B.</li>
</ul>
<p>Node A can send a document to Node B using the following steps:</p>
<ol>
<li><p>Node A searches for Node B using the Centrifuge ID that helps identify Node B on the peer-to-peer network.</p></li>
<li><p>The upstream system provides Node A's Centrifuge ID.</p></li>
<li><p>Node A looks up the public keys attached to Node B's Centrifuge ID on Ethereum.</p></li>
<li><p>Node A then resolves Node B's address by retrieving public keys on the public blockchain using lip2p and a distributed hash table that contains the mapping between the public key and Node B's address.</p></li>
</ol>
<p>Now that Node A knows the identity and location of Node B, it can share the document.</p>
<p>Upon receipt, Node B processes the document by calculating the Merkle root according to the same rules as Node A and then signs the root with its own private key. Node B now has the following options to deal with the document:</p>
<ol>
<li><p>Reply with a signed root hash to signal an agreement for document validity.</p></li>
<li><p>End the communication and store the calculated document plus hash locally.</p></li>
<li><p>Submit its own signed hash to the public blockchain to anchor the document or append the signature chain if the sender node had previously anchored the document.</p></li>
</ol>
<p>In the normal course of interaction, Node B would return its signature of the root hash to Node A. Node A then creates another Merkle Tree from the collection of all signatures (Node A, Node B) and the document root hash, plus some additional information. The root hash of this Merkle Tree is committed to Ethereum as the next anchor.</p>
<p>Throughout the process all upstream systems associated with Node A and Node B are notified of the document transfer status and can process information as necessary on either end.</p>
<h2><a class="anchor" aria-hidden="true" id="changes-to-a-shared-document"></a><a href="#changes-to-a-shared-document" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Changes to a Shared Document</h2>
<p>After a document has been shared between collaborators and the receiving collaborator has acknowledged the document, they can edit or modify a shared document. In such a scenario, there could be multiple outcomes as described the following example:</p>
<ul>
<li>User A (at Node A) submits an update to the document by requesting a lock on the document from User B (at Node B) for a certain period of time (block height).</li>
<li>User B acknowledges the lock commitment and does not make any changes to the document in that period.</li>
<li>User A requests a signature from User B for the updated document.</li>
<li>User B signs the request.</li>
<li>User A then submits an anchor to Ethereum to save the updated, acknowledged document as the new version.</li>
</ul>
<p>This is the simplest scenario where all users are responsive and accommodating of other user's requests. There are more complicated scenarios where user's could potentially time out, or be malicious and update the document without acknowledging the other user's request to update the document.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/getting-started/install-cent-node"><span class="arrow-prev">← </span><span>Previous</span></a><a class="docs-next button" href="/docs/cent-os-administration/manage-cent-os"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/centrifuge_mark_white.svg" alt="Centrifuge Developer" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/getting-started/prerequisites">Getting Started</a><a href="https://app.swaggerhub.com/apis/centrifuge.io/cent-node/0.0.3" target="_blank" rel="noreferrer noopener">Centrifuge Node Api</a><a href="/docs/further-reading/code-of-conduct">Code of conduct</a></div><div><h5>Community</h5><a href="https://medium.com/centrifuge" target="_blank" rel="noreferrer noopener">Medium</a><a href="https://twitter.com/centrifuge" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://join.slack.com/t/centrifuge-io/shared_invite/enQtNDk1MzkwODM4OTgxLWRlNTU4NDQzOWIwYWEzNGRhN2UzMzQwNThjZjI0ZmIxMTU4NmQwMjc2ZDBkOTEyNWJhMjE4MzA2NTE5MWU1NWE" target="_blank" rel="noreferrer noopener">Slack</a></div><div><h5>More</h5><a href="https://github.com/centrifuge/go-centrifuge" target="_blank" rel="noreferrer noopener">GitHub</a><a class="github-button" href="https://github.com/centrifuge/go-centrifuge" data-icon="octicon-star" data-count-href="/centrifuge/go-centrifuge/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Centrifuge Inc</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: 'e1804220d11b9eefa76395d7f70a2e45',
                indexName: 'centrifuge',
                inputSelector: '#search_input_react'
              });
            </script></body></html>